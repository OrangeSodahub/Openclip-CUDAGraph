## Openclip-CUDAGraph
Tips: There are three steps from the original model to final callable optimized model:
1. Trace the torch model through `torch.fx._symbolic_trace` to generate `torch.fx.GraphModuel` object.
2. Replace some modules in this object to optimize it **(not included in this version)** and output is a `torch.fx.GraphModuel` object.
3. Build static graph model through `torch.cuda.CUDAGraph`.
And also not use `torchdynamo.optimize()`.

### Benchmark

It saves the time cost on starting the model multiply times.

Tested on RTX3080:

---------------------------------------------------------------------------------
times   |shape     | model                      | pt (s)   | graph (s)| saved (%)
--------|----------|----------------------------|----------|----------|----------
|1      |(1, 77)   |ViT-L-14::laion2b-s32b-b82k |0.5031    |1.4660    |-191.40%
|       |(2, 77)   |                            |0.0073    |1.2455    |-16742.68%
|       |(4, 77)   |                            |0.0070    |1.2285    |-17288.66%
|       |(8, 77)   |                            |0.0071    |1.2160    |-16885.65%
|       |(16, 77)  |                            |0.0087    |1.3552    |-15376.76%
|       |(1, 3, 224, 224)|                      |0.0134    |3.9472    |-29321.34%
|       |(2, 3, 224, 224)|                      |0.0352    |4.0213    |-11305.23%
|       |(4, 3, 224, 224)|                      |0.0323    |4.0170    |-12320.65%
|       |(8, 3, 224, 224)|                      |0.0416    |4.1213    |-9796.87%
|100    |(1, 77)   |ViT-L-14::laion2b-s32b-b82k |0.0645    |1.2155    |-1782.99%
|       |(2, 77)   |                            |0.0749    |1.2515    |-1569.83%
|       |(4, 77)   |                            |0.0659    |1.2397    |-1779.11%
|       |(8, 77)   |                            |0.0672    |1.2721    |-1790.81%
|       |(16, 77)  |                            |0.0855    |1.2930    |-1411.15%
|       |(1, 3, 224, 224)|                      |0.1328    |3.9772    |-2894.45%
|       |(2, 3, 224, 224)|                      |0.1507    |4.0623    |-2594.21%
|       |(4, 3, 224, 224)|                      |0.3066    |4.2564    |-1288.65%
|       |(8, 3, 224, 224)|                      |0.3949    |4.4650    |-1030.98%
|1000   |(1, 77)   |ViT-L-14::laion2b-s32b-b82k |6.3198    |2.8705    |54.57%
|       |(2, 77)   |                            |6.5773    |3.2326    |50.85%
|       |(4, 77)   |                            |6.6337    |3.5442    |46.57%
|       |(8, 77)   |                            |6.7029    |4.8351    |27.86%
|       |(16, 77)  |                            |8.0548    |8.7625    |-8.785%
|       |(1, 3, 224, 224)|                      |13.0253   |11.9307   |8.40%
|       |(2, 3, 224, 224)|                      |15.0432   |17.7647   |-18.09%
|       |(4, 3, 224, 224)|                      |-         |-         |-
|10000  |(1, 77)   |ViT-L-14::laion2b-s32b-b82k |63.0495   |18.0050   |71.44%
|       |(2, 77)   |                            |65.4867   |21.7872   |66.73%
|       |(4, 77)   |                            |64.9916   |24.3028   |62.60%
|       |(8, 77)   |                            |65.7108   |37.9319   |42.27%
|       |(16, 77)  |                            |81.8811   |77.0026   |5.95%
|       |(1, 3, 224, 224)|                      |-         |-         |
|       |(2, 3, 224, 224)|                      |-         |-         |
|       |(4, 3, 224, 224)|                      |-         |-         |

